function changeAjaxCall(t){$.ajax({type:"get",url:t.url,data:t,success:function(e){t.changeAddressAjax?(alert(t.successMsg),window.location.href=t.redirect):window.location.href=e.redirectUrl}})}function setDefaultCurrency(t){var a=$(".esw-country-selector.selectCurrency .select-field"),r=$(".esw-country-selector.selectCurrency .select-field .current-country"),e=$("#selected-country"),n=e.attr("data-value"),e=e.attr("data-url");$.ajax({type:"get",url:e,data:{country:n},success:function(e){e.success&&(t.html(e.currencyName+" "+e.currencySymbol),t.attr("data-value",e.currency),e.isAllowed?(a.removeClass("disabled"),r.removeClass("disabled")):(a.addClass("disabled"),r.addClass("disabled")))}})}function openEswCountrySwitcher(e){$.ajax({type:"get",url:e.eswLandingPageUrl,data:e,success:function(e){$("footer").append(e);e=$("#selected-currency");0<e.length&&setDefaultCurrency(e)}})}function updateCountryList(){$(document).on("click",".btnCheckout",function(e){e.preventDefault(),$.ajax({type:"get",url:$(this).attr("data-url"),data:"",success:function(e){window.open(e.redirectURL,"_self")}})}),$(document).on("click","body",function(e){$(e.target).closest("#eswModal").length||$(e.target).is("#eswModal")||$(".eswModal").hide()}),$("body").on("click",".esw-country-selector .selector a.landing-link",function(e){e.preventDefault();e=$(this).parents(".select-field");$(e).find("span").attr("data-value",$(this).attr("data-param")),$(e).find(".current-country .flag-icon").attr("class","flag-icon flag-icon-"+$(this).attr("data-param").toLowerCase()),$(e).find("span").text($(this).text())}),$("body").on("click",".esw-country-selector .selector .country.landing-link",function(){var e=$("#selected-currency");0<e.length&&setDefaultCurrency(e)}),$("body").on("click",".esw-country-selector .selector .country.landing-link",function(){var t=$("#selected-currency"),e=$("#selected-country"),a=e.attr("data-value"),e=e.attr("data-url");0<t.length&&$.ajax({type:"get",url:e,data:{country:a},success:function(e){e.success&&(t.html(e.currencyName+" "+e.currencySymbol),t.attr("data-value",e.currency),$(".eswModal .eswGeoLookup").removeClass("autoselected").addClass("selected"),document.cookie="esw.locationAutoSelected=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT",$(".esw-btn").click())}})}),$(document).on("click",".esw-btn",function(){var e=$("#selected-country").attr("data-value"),t=$("#selected-currency").attr("data-value"),a=$("#selected-locale").attr("data-value");e?(t=t||$("#selected-country").closest(".select-field").find(".country a:first").attr("data-currency"),a=a||$("#selected-country").closest(".select-field").find(".country a:first").attr("data-locale")):a?(t=t||$("#selected-locale").closest(".select-field").find(".country a:first").attr("data-currency"),e=e||$("#selected-locale").closest(".select-field").find(".country a:first").attr("data-country")):t&&(e=e||$("#selected-currency").closest(".select-field").find(".country a:first").attr("data-currency"),a=a||$("#selected-currency").closest(".select-field").find(".country a:first").attr("data-locale")),changeAjaxCall({country:e,currency:t,language:a,url:$(this).attr("data-url"),action:$(".page").data("action"),queryString:$(".page").data("querystring")})}),$(".headerDropdown, .footerDropdown").click(function(e){openEswCountrySwitcher({eswLandingPageUrl:$(this).attr("data-url"),dropDownSelection:"true"})}),$(document).on("click",".selected-link",function(){changeAjaxCall({country:$(this).attr("data-country"),currency:$(this).attr("data-currency"),language:$(this).attr("data-locale"),url:$(this).attr("data-url"),action:$(".page").data("action"),queryString:$(".page").data("querystring")})}),$("body").on("click",".esw-country-selector .current-country",function(e){e.stopPropagation();e=$(this).siblings(".selector");e.toggleClass("active"),$(this).toggleClass("selector-active"),$(".esw-country-selector .selector").not(e).removeClass("active"),$(".esw-country-selector .current-country").not(this).removeClass("selector-active")}),$("body").on("product:afterAttributeSelect",function(e,t){t.data.product.isProductRestricted?($(".modal.show").find("button.update-cart-product-global").addClass("d-none"),$(".modal.show").find(".price").addClass("d-none"),$(".modal.show").find(".product-not-available-msg").removeClass("d-none")):($(".modal.show").find("button.update-cart-product-global").removeClass("d-none"),$(".modal.show").find(".price").removeClass("d-none"),$(".modal.show").find(".product-not-available-msg").addClass("d-none"))})}function applyRoundingMethod(e,t,a,r){var n,c,o,s,d,l=t.split(/(\d+)/)[0];return"none"==l.toLowerCase()?r?e/100%1:e:(n=(t=t.split(/(\d+)/)[1]).length,r&&(n=(t=1===n?t+"0":t.substring(0,2)).length),"fixed"==l.toLowerCase()?(c=e-(l=e%Math.pow(10,n)),"up"==a.direction.toLowerCase()?d=(t<l?c+ +Math.pow(10,n):c)+Number(t):"down"==a.direction.toLowerCase()?d=(d=(l<t?c-+Math.pow(10,n):c)+Number(t))<0&&!r?e:d:"nearest"==a.direction.toLowerCase()&&(o=(t<l?c+ +Math.pow(10,n):c)+Number(t),s=(s=(l<t?c-+Math.pow(10,n):c)+Number(t))<0&&!r?e:s,d=Math.abs(o-e)>=Math.abs(e-s)?s:o)):"up"==a.direction.toLowerCase()?d=Math.ceil(e/t)*t:"down"==a.direction.toLowerCase()?d=Math.floor(e/t)*t:"nearest"==a.direction&&(o=Math.ceil(e/t)*t,s=Math.floor(e/t)*t,d=Math.abs(o-e)>=Math.abs(e-s)?s:o),r?d/Math.pow(10,n):d)}function applyRoundingModel(e){var t,a,r,n=!!window.SitePreferences.ESW_SELECTED_ROUNDING&&JSON.parse(window.SitePreferences.ESW_SELECTED_ROUNDING),c=0;return n&&0!==e&&n?(e=e.toFixed(2),a=parseInt(e,10),t=n.model.split(".")[0],r=applyRoundingMethod(Math.round(e%1*100),n.model.split(".")[1],n,!0),r=((a=parseInt(a+r,10))+r)%1,c=applyRoundingMethod(a,t,n,!1)+r,0===n.currencyExponent?parseInt(c,10):c.toFixed(n.currencyExponent)):e}function convertPrice(){var e=$(".esw-price:not(.esw-price-converted)"),n=window.SitePreferences.ESW_CURRENCY_SYMBOL;if(window.SitePreferences.ESW_FIXED_COUNTRY)e.each(function(){var e=$(this),t=Number($.trim(e.text()).replace(/[^0-9\.-]+/g,""));e.text(n+t),e.addClass("esw-price-converted")});else{var c=window.SitePreferences.ESW_SELECTED_COUNTRY_ADJUSTMENT?JSON.parse(window.SitePreferences.ESW_SELECTED_COUNTRY_ADJUSTMENT):"",o=window.SitePreferences.ESW_SELECTED_FXRATE?JSON.parse(window.SitePreferences.ESW_SELECTED_FXRATE):"",s=window.SitePreferences.ESW_ENABLE_ROUNDING;if(!o)return!1;e.each(function(){var e=$(this),t=!(!e.attr("data-disable-rounding")||"true"!=e.attr("data-disable-rounding")),a=!(!e.attr("data-disable-adjustments")||"true"!=e.attr("data-disable-adjustments")),r=Number($.trim(e.text()).replace(/[^0-9\.-]+/g,""));c&&!a&&(r=(r=(r+=Number(c.retailerAdjustments.priceUpliftPercentage/100*r))+Number(c.estimatedRates.dutyPercentage/100*r))+Number(c.estimatedRates.taxPercentage/100*r)),r=Number((r*o.rate).toFixed(2)),!t&&s&&(r=applyRoundingModel(r)),e.text(n+r),e.addClass("esw-price-converted")})}}$(document).ready(function(){updateCountryList(),void 0!==window.SitePreferences&&window.SitePreferences.ESW_ENABLE_PRICECONVERSION&&(convertPrice(),$(document).ajaxComplete(function(e,t,a){convertPrice()}))});